(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079309d5"],{"0e7a":function(t,e,i){"use strict";i.r(e);var n,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"btnWrapper"},[i("el-button-group",[i("el-button",{attrs:{type:"primary",icon:"el-icon-bottom"},on:{click:t.openAll}},[t._v("展开")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.closeAll}},[t._v("收起"),i("i",{staticClass:"el-icon-top"})])],1),t._v(" "),i("el-button-group",[i("el-button",{attrs:{type:"primary",icon:"el-icon-s-claim"},on:{click:t.save}},[t._v("保存")]),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.refresh}},[t._v("刷新")])],1)],1),t._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,md:12}},[i("vuedraggable",{staticClass:"wrapper",model:{value:t.items,callback:function(e){t.items=e},expression:"items"}},[i("transition-group",{attrs:{name:"fade"}},t._l(t.items,(function(e,n){return i("div",{key:n},[i("div",{staticClass:"item clearfix"},[i("div",{staticClass:"itemName pull-left"},[t.getType(e.list)?i("span",[e.list.length>0?i("el-button",{class:e.open&&e.list.length>0?"el-icon-minus":"el-icon-plus",attrs:{type:"text"},on:{click:function(i){return t.silggle(e.title)}}}):t._e()],1):t._e(),t._v(" "),i("i",{class:e.icon}),t._v("\n\n                "+t._s(e.title)+"\n              ")]),t._v(" "),i("div",{staticClass:" pull-right"},[i("el-button",{staticClass:"el-icon-circle-plus-outline",attrs:{type:"text",title:"添加子菜单"},on:{click:function(i){return t.openModal("add","添加子菜单",e.id)}}}),t._v(" "),i("el-button",{staticClass:"el-icon-edit-outline",attrs:{type:"text"},on:{click:function(i){return t.openModal("edit","修改菜单",e.id)}}}),t._v(" "),i("el-popconfirm",{attrs:{title:"确定删除该菜单吗"},on:{onConfirm:function(i){return t.clickDel(e.title)}}},[i("el-button",{staticClass:"el-icon-delete",attrs:{slot:"reference",type:"text"},slot:"reference"})],1)],1)]),t._v(" "),i("el-collapse-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"item.open"}]},[t.getType(e.list)?i("div",{staticClass:"list",style:"margin-left:20px;"},[i("vuedraggable",{model:{value:t.items.item,callback:function(e){t.$set(t.items,"item",e)},expression:"items.item"}},t._l(e.list,(function(n,s){return i("div",{key:s},[i("div",{staticClass:"item clearfix"},[i("div",{staticClass:"itemName pull-left"},[i("i",{class:n.icon}),t._v("\n                          "+t._s(n.title)+"\n                          "),i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.routePush(e.uri+"/"+n.uri)}}},[t._v(t._s(e.uri+"/"+n.uri))])],1),t._v(" "),i("div",{staticClass:"itemName pull-right"},[i("el-button",{staticClass:"el-icon-edit-outline",attrs:{type:"text"},on:{click:function(e){return t.openModal("edit","修改子菜单",n.id)}}}),t._v(" "),i("el-popconfirm",{attrs:{title:"确定删除该菜单吗"},on:{onConfirm:function(e){return t.clickDel(n.id)}}},[i("el-button",{staticClass:"el-icon-delete",attrs:{slot:"reference",type:"text"},slot:"reference"})],1)],1)])])})),0)],1):t._e()])])],1)})),0)],1)],1),t._v(" "),i("el-col",{attrs:{xs:24,md:12}},[i("div",{staticClass:"h1Title"},[t._v("添加顶级菜单")]),t._v(" "),i("create-form",{attrs:{dataList:t.dataList,width:"100%",labelWidth:"120px"},on:{getValue:t.getChild}})],1)],1),t._v(" "),i("addOrEditMenu",{attrs:{roleList:t.roleList,visible:t.visible,title:t.pageInit.title,pageType:t.pageInit.pageType,id:t.pageInit.id},on:{close:t.closeModal}})],1)},o=[],a=(i("ac6a"),i("310e")),l=i.n(a),r=i("5f87"),c=i("7b0d"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,visible:t.show,width:"600px","before-close":t.handleClose},on:{"update:visible":function(e){t.show=e},open:t.open}},[i("create-form",{attrs:{dataList:t.dataList,width:"100%",labelWidth:"120px"},on:{getValue:t.getChild}})],1)},d=[],p=(i("8e6e"),i("456d"),i("c5f6"),i("28a5"),i("bd86")),f=i("55d9");function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){Object(p["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var v={name:"detailed",data:function(){return{dataList:[],menuInfo:{}}},props:(n={visible:{type:Boolean,required:!0},id:{default:""}},Object(p["a"])(n,"id",{default:""}),Object(p["a"])(n,"pageType",{type:String,default:"add"}),Object(p["a"])(n,"title",String),Object(p["a"])(n,"roleList",{type:Array,default:[]}),n),computed:{show:{get:function(){return this.visible},set:function(t){this.$emit("close",t)}}},methods:{close:function(){this.tableData=[]},open:function(){var t=[{title:"菜单名称",type:"text",id:"title",required:!0},{title:"图标",type:"icon",id:"icon"},{title:"路径",type:"text",id:"uri",required:!0},{title:"角色",type:"select",id:"roleId",multiple:!0,required:!0,option:this.roleList,optionObj:{key:"name",value:"id"},value:[]}];this.dataList=t;this.id,this.pageType,this.title;this.getDetail()},getChild:function(t){var e=this,i=this.pageType,n=this.menuInfo,s=n.parentId,o=n.id;t.icon=Object(r["g"])(t.icon)?t.icon:"","edit"===i?(t.id=o,t.parentId=s):t.parentId=o,t.roleId=t.roleId.join(","),Object(f["o"])(t,i).then((function(t){0===t.statusCode&&(e.$message({message:"菜单".concat("add"===i?"创建":"修改","成功"),type:"success"}),e.$store.dispatch("user/getMenuList",{payload:e.$store.state.user.userInfo.id}),e.$emit("close",!1,!0))}))},getDetail:function(){var t=this,e={};e.id=this.id,Object(f["t"])(e,this.title).then((function(e){if(0===e.statusCode){var i=e.content;if(t.menuInfo=i,"edit"===t.pageType){var n=t.dataList,s=[];n.forEach((function(t){t.value=i[t.id];var e=m({},t);e.value=i[t.id],"roleId"===t.id&&(e.value="String"===Object(r["c"])(i[t.id])?i[t.id].split(",").map(Number):[]),s.push(e)})),t.dataList=s}}}))},handleClose:function(){this.dataList.forEach((function(t){t.value=""})),this.$emit("close",!1)}},components:{CreateForm:c["a"]}},g=v,b=i("2877"),y=Object(b["a"])(g,u,d,!1,null,null,null),O=y.exports,_={name:"menuMange",data:function(){return{items:[],form:{},open:!1,flag:!0,visible:!1,pageInit:{title:"",pageType:"",id:""},dataList:[{title:"菜单名称",type:"text",id:"title",required:!0},{title:"图标",type:"icon",id:"icon"},{title:"路径",type:"text",id:"uri",required:!0},{title:"角色",type:"select",id:"roleId",multiple:!0,required:!0,option:[],optionObj:{key:"name",value:"id"},value:[]}],roleList:[]}},watch:{"$store.state.backstageSetting.roleList":{handler:function(t){this.dataList[3].option=t,this.roleList=t},deep:!0},items:{handler:function(t){this.items=t},deep:!0}},mounted:function(){this.getMenuList(),this.$store.dispatch({type:"backstageSetting/getRoleList"})},components:{addOrEditMenu:O,vuedraggable:l.a,CreateForm:c["a"]},methods:{save:function(){this.$message({message:"保存成功",type:"success"})},refresh:function(){this.$router.go(0)},getChild:function(t){var e=this;t.parentId=0,t.roleId=t.roleId.join(","),t.icon=Object(r["g"])(t.icon)?t.icon:"",Object(f["o"])(t,"add").then((function(t){0===t.statusCode&&(e.$message({message:"菜单创建成功",type:"success"}),e.getMenuList(),e.$store.dispatch("user/getMenuList",{payload:e.$store.state.user.userInfo.id}))}))},getMenuList:function(){var t=this;Object(f["p"])().then((function(e){var i=e.content;i.forEach((function(t){t.open=!0})),t.items=i})).catch((function(){}))},spanClick:function(){},routePush:function(t){this.$router.push(t)},closeModal:function(t,e){this.visible=t,e&&this.getMenuList()},openModal:function(t,e,i){this.pageInit={title:e,pageType:t,id:i},this.visible=!0},clickDel:function(t){var e=this;"String"===Object(r["c"])(t)?Object(f["t"])({title:t}).then((function(t){if(0===t.statusCode){var i=t.content;e.delateMenu(i.id)}})):this.delateMenu(t)},delateMenu:function(t){var e=this;Object(f["b"])({id:t}).then((function(t){0===t.statusCode&&(e.getMenuList(),e.$message({message:"删除成功",type:"success"}))}))},openAll:function(){var t=this.items;t.forEach((function(t){t.open=!0}))},closeAll:function(){var t=this.items;t.forEach((function(t){t.open=!1}))},silggle:function(t){var e=this.items;e.forEach((function(e){e.title===t&&(e.open=!e.open)}))},getType:function(t){return"Array"===Object(r["c"])(t)}}},j=_,C=(i("16fa"),Object(b["a"])(j,s,o,!1,null,"6687ee3a",null));e["default"]=C.exports},"16fa":function(t,e,i){"use strict";var n=i("b9e9"),s=i.n(n);s.a},b9e9:function(t,e,i){}}]);